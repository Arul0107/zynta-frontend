import{r as h,x as e,B as n,y as k,V as i}from"./index-Dx0fORvq.js";import{i as c}from"./axios-By3bUnR1.js";import{F as d}from"./index-BHKMv-_S.js";import{R}from"./PlusOutlined-Dt2q3nHd.js";import{F as E}from"./Table-BFHR8fXI.js";import{D as v}from"./index-C3OeHxcS.js";import{I as B}from"./index-CycGH6gG.js";import{R as A}from"./EditOutlined--TcujLaX.js";import{P as O}from"./index-D4CZw55Y.js";import{R as _}from"./DeleteOutlined-DlHM_4f9.js";import"./TextArea-Bqwst6Wg.js";import"./row-D7mQAf0A.js";import"./ExclamationCircleFilled-ctPYYyzk.js";import"./styleChecker-BIxzM-w-.js";import"./addEventListener-CZDGFXVg.js";import"./index-Bcd2XmZI.js";import"./index-Bq5jwgzS.js";import"./Pagination-9G_nljkd.js";import"./extendsObject-78o_rR5W.js";import"./context-LTZAWJIx.js";import"./useClosable-D6ihuouj.js";import"./ActionButton-DcYFGn3W.js";const ae=({departments:D,fetchDepartments:u,fetchTeams:x,fetchUsers:f})=>{const[C,o]=h.useState(!1),[m,y]=h.useState(null),[l]=d.useForm(),s=JSON.parse(localStorage.getItem("user")),g=(s==null?void 0:s.role)==="Superadmin",j=(s==null?void 0:s.role)==="Admin",w=()=>{y(null),l.resetFields(),o(!0)},F=r=>{y(r),l.setFieldsValue({name:r.name,description:r.description}),o(!0)},b=async()=>{var r,a;try{const t=await l.validateFields();m?(await c.put(`/api/departments/${m._id}`,t),i.success("Department updated successfully")):(await c.post("/api/departments",t),i.success("Department created successfully")),o(!1),u(),x(),f()}catch(t){console.error(t),i.error(((a=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to submit department")}},I=async r=>{var a,t;try{await c.delete(`/api/departments/${r}`),i.success("Department deleted"),u(),x(),f()}catch(p){i.error(((t=(a=p==null?void 0:p.response)==null?void 0:a.data)==null?void 0:t.message)||"Delete failed")}},S=[{title:"Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",render:(r,a)=>e.jsx(k,{children:(g||j)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:e.jsx(A,{}),onClick:()=>F(a)}),e.jsx(O,{title:"Delete this department?",onConfirm:()=>I(a._id),children:e.jsx(n,{danger:!0,icon:e.jsx(_,{})})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Department Management"}),(g||j)&&e.jsx(n,{type:"primary",style:{backgroundColor:"#0E2B43",borderColor:"#orange",color:"white"},icon:e.jsx(R,{}),onClick:w,children:"Create Department"})]}),e.jsx(E,{columns:S,dataSource:D,rowKey:"_id",bordered:!0}),e.jsx(v,{title:m?"Edit Department":"Create Department",open:C,onClose:()=>o(!1),width:420,destroyOnClose:!0,footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(n,{onClick:()=>o(!1),style:{marginRight:8},children:"Cancel"}),e.jsx(n,{type:"primary",style:{backgroundColor:"#0E2B43",borderColor:"#orange",color:"white"},onClick:b,children:m?"Update":"Create"})]}),children:e.jsx(d,{form:l,layout:"vertical",children:e.jsx(d.Item,{name:"name",label:"Department Name",rules:[{required:!0,message:"Department name is required"}],children:e.jsx(B,{})})})})]})};export{ae as default};
