import{r as h,x as e,B as n,y as k,V as i}from"./index-DysXtrl7.js";import{i as d}from"./axios-Dbq_CbWC.js";import{F as p}from"./index-cDs3jJ7o.js";import{R}from"./PlusOutlined-BIwFneT8.js";import{F as E}from"./Table-DflE-h7Z.js";import{D as v}from"./index-BYWlwTeH.js";import{I as B}from"./index-N4YTd5WF.js";import{R as A}from"./EditOutlined-C9Bhlaw5.js";import{P as O}from"./index-th8N7Gjr.js";import{R as _}from"./DeleteOutlined-ine2ZxG6.js";import"./row-BYIzmBXD.js";import"./TextArea-Bqbh4RKI.js";import"./styleChecker-w1bbWMN2.js";import"./addEventListener-D04I5D8z.js";import"./index-qBajPA1p.js";import"./index-BrgBQ01W.js";import"./Pagination-ByOtUXMd.js";import"./extendsObject-78o_rR5W.js";import"./context-DDkc41cA.js";import"./useClosable-DxUighul.js";import"./ActionButton-C6N_UzTp.js";const re=({departments:D,fetchDepartments:u,fetchTeams:x,fetchUsers:f})=>{const[C,o]=h.useState(!1),[m,y]=h.useState(null),[l]=p.useForm(),s=JSON.parse(localStorage.getItem("user")),g=(s==null?void 0:s.role)==="Superadmin",j=(s==null?void 0:s.role)==="Admin",w=()=>{y(null),l.resetFields(),o(!0)},F=r=>{y(r),l.setFieldsValue({name:r.name,description:r.description}),o(!0)},b=async()=>{var r,a;try{const t=await l.validateFields();m?(await d.put(`/api/departments/${m._id}`,t),i.success("Department updated successfully")):(await d.post("/api/departments",t),i.success("Department created successfully")),o(!1),u(),x(),f()}catch(t){console.error(t),i.error(((a=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:a.message)||"Failed to submit department")}},I=async r=>{var a,t;try{await d.delete(`/api/departments/${r}`),i.success("Department deleted"),u(),x(),f()}catch(c){i.error(((t=(a=c==null?void 0:c.response)==null?void 0:a.data)==null?void 0:t.message)||"Delete failed")}},S=[{title:"Name",dataIndex:"name",key:"name"},{title:"Actions",key:"actions",render:(r,a)=>e.jsx(k,{children:(g||j)&&e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:e.jsx(A,{}),onClick:()=>F(a)}),e.jsx(O,{title:"Delete this department?",onConfirm:()=>I(a._id),children:e.jsx(n,{danger:!0,icon:e.jsx(_,{})})})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:16},children:[e.jsx("h2",{children:"Department Management"}),(g||j)&&e.jsx(n,{type:"primary",style:{backgroundColor:"#0E2B43",borderColor:"#orange",color:"white"},icon:e.jsx(R,{}),onClick:w,children:"Create Department"})]}),e.jsx(E,{columns:S,dataSource:D,rowKey:"_id",bordered:!0}),e.jsx(v,{title:m?"Edit Department":"Create Department",open:C,onClose:()=>o(!1),width:420,destroyOnClose:!0,footer:e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx(n,{onClick:()=>o(!1),style:{marginRight:8},children:"Cancel"}),e.jsx(n,{type:"primary",style:{backgroundColor:"#0E2B43",borderColor:"#orange",color:"white"},onClick:b,children:m?"Update":"Create"})]}),children:e.jsx(p,{form:l,layout:"vertical",children:e.jsx(p.Item,{name:"name",label:"Department Name",rules:[{required:!0,message:"Department name is required"}],children:e.jsx(B,{})})})})]})};export{re as default};
