import{u as h,P as f,q as e,s as c,V as d}from"./index-Db3Ct3vh.js";import{r as o,C as x,F as r,c as m,B as w}from"./antd-CjRtIVzR.js";import"./react-DoC2WAmd.js";import"./icons-De3RWgvB.js";const j="/assets/vrismw-DBePaPe4.png",P=()=>{const a=h(),[t,l]=o.useState(!1),{socket:p}=o.useContext(f);o.useEffect(()=>{window.history.pushState(null,"",window.location.href),window.onpopstate=()=>a("/login",{replace:!0})},[]);const u=async n=>{try{l(!0);const i=await c.post("/api/auth/login",{username:n.email,password:n.password}),{user:s,token:g}=i.data;localStorage.setItem("user",JSON.stringify(s)),localStorage.setItem("token",g),localStorage.setItem("token_expiry",Date.now()+2*24*60*60*1e3),await c.post("/api/users/status/update",{userId:s._id,presence:"online"}),p.emit("presence_change",{userId:s._id,presence:"online"}),d.success(`Welcome ${s.name}!`),s.role==="SuperAdmin"||s.role==="Admin"?a("/taskmanage"):s.role==="Team Leader"||s.role==="Employee"?a("/attendance"):s.role==="Client"?a("/subscriptions"):a("/eodreport")}catch{d.error("Invalid credentials")}finally{l(!1)}};return e.jsxs("div",{className:"login-wrapper",children:[e.jsxs("div",{className:"login-left",children:[e.jsx("img",{src:j,alt:"Vrism Logo",className:"logo-img"}),e.jsxs(x,{className:"login-card",bordered:!1,children:[e.jsx("h2",{className:"login-title",children:"Log In"}),e.jsx("p",{className:"login-subtitle",children:"Welcome back! Please enter your details"}),e.jsxs(r,{layout:"vertical",onFinish:u,children:[e.jsx(r.Item,{name:"email",label:e.jsx("span",{style:{color:"#fff"},children:"Email"}),rules:[{required:!0,message:"Please enter your email"}],children:e.jsx(m,{placeholder:"Enter email"})}),e.jsx(r.Item,{name:"password",label:e.jsx("span",{style:{color:"#fff"},children:"Password"}),rules:[{required:!0,message:"Please enter your password"}],children:e.jsx(m.Password,{placeholder:"Enter password"})}),e.jsx("div",{className:"forgot-password-wrapper",children:e.jsx("a",{href:"/forgot-password",className:"forgot-password",children:"Forgot password?"})}),e.jsx(r.Item,{children:e.jsx(w,{type:"primary",htmlType:"submit",block:!0,className:"login-button",loading:t,children:t?"Logging in...":"Log in"})})]})]})]}),e.jsx("div",{className:"login-right"})]})};export{P as default};
