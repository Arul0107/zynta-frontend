import{r as g,t as re,c as V,p as se,d as U,q as B,e as ce,a1 as _,g as oe,m as le,a as de,u as E,b4 as he,a4 as me,J as ue,ap as ge,aT as pe,ba as Se,ao as xe,x as e,y as ve,B as N,V as C,S as be,ar as J,T as R}from"./index-DysXtrl7.js";import{i as P}from"./axios-Dbq_CbWC.js";import{F as v}from"./index-cDs3jJ7o.js";import{D as F}from"./index-BYWlwTeH.js";import{R as L,C as T}from"./row-BYIzmBXD.js";import{I as k,R as ye}from"./index-N4YTd5WF.js";import{R as je}from"./MinusCircleOutlined-B9O64eBj.js";import{R as G}from"./PlusOutlined-BIwFneT8.js";import{R as fe}from"./SendOutlined-D4no-W0M.js";import{T as Ce}from"./index-PWcPX8J0.js";import{T as Q}from"./index-CL3JxQbZ.js";import{F as W}from"./Table-DflE-h7Z.js";import{D as y}from"./index-PRXoTW3I.js";import{T as z}from"./index-BBTWRX9T.js";import{C as Y}from"./Collapse-DoHxGrQW.js";import{R as Ie}from"./EditOutlined-C9Bhlaw5.js";import{R as we}from"./MessageOutlined-BZo189Jp.js";import{P as $e}from"./index-th8N7Gjr.js";import{R as ke}from"./DeleteOutlined-ine2ZxG6.js";import"./TextArea-Bqbh4RKI.js";import"./context-DDkc41cA.js";import"./useClosable-DxUighul.js";import"./extendsObject-78o_rR5W.js";import"./styleChecker-w1bbWMN2.js";import"./index-qBajPA1p.js";import"./addEventListener-D04I5D8z.js";import"./index-BrgBQ01W.js";import"./Pagination-ByOtUXMd.js";import"./ActionButton-C6N_UzTp.js";var Ne=["prefixCls","className","checked","defaultChecked","disabled","loadingIcon","checkedChildren","unCheckedChildren","onClick","onChange","onKeyDown"],Z=g.forwardRef(function(n,t){var s,i=n.prefixCls,c=i===void 0?"rc-switch":i,h=n.className,o=n.checked,a=n.defaultChecked,r=n.disabled,l=n.loadingIcon,u=n.checkedChildren,x=n.unCheckedChildren,m=n.onClick,S=n.onChange,b=n.onKeyDown,f=re(n,Ne),$=V(!1,{value:o,defaultValue:a}),I=se($,2),d=I[0],p=I[1];function M(j,A){var D=d;return r||(D=j,p(D),S==null||S(D,A)),D}function H(j){j.which===_.LEFT?M(!1,j):j.which===_.RIGHT&&M(!0,j),b==null||b(j)}function w(j){var A=M(!d,j);m==null||m(A,j)}var q=U(c,h,(s={},B(s,"".concat(c,"-checked"),d),B(s,"".concat(c,"-disabled"),r),s));return g.createElement("button",ce({},f,{type:"button",role:"switch","aria-checked":d,disabled:r,className:q,ref:t,onKeyDown:H,onClick:w}),l,g.createElement("span",{className:"".concat(c,"-inner")},g.createElement("span",{className:"".concat(c,"-inner-checked")},u),g.createElement("span",{className:"".concat(c,"-inner-unchecked")},x)))});Z.displayName="Switch";const Ee=n=>{const{componentCls:t,trackHeightSM:s,trackPadding:i,trackMinWidthSM:c,innerMinMarginSM:h,innerMaxMarginSM:o,handleSizeSM:a,calc:r}=n,l=`${t}-inner`,u=E(r(a).add(r(i).mul(2)).equal()),x=E(r(o).mul(2).equal());return{[t]:{[`&${t}-small`]:{minWidth:c,height:s,lineHeight:E(s),[`${t}-inner`]:{paddingInlineStart:o,paddingInlineEnd:h,[`${l}-checked, ${l}-unchecked`]:{minHeight:s},[`${l}-checked`]:{marginInlineStart:`calc(-100% + ${u} - ${x})`,marginInlineEnd:`calc(100% - ${u} + ${x})`},[`${l}-unchecked`]:{marginTop:r(s).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`${t}-handle`]:{width:a,height:a},[`${t}-loading-icon`]:{top:r(r(a).sub(n.switchLoadingIconSize)).div(2).equal(),fontSize:n.switchLoadingIconSize},[`&${t}-checked`]:{[`${t}-inner`]:{paddingInlineStart:h,paddingInlineEnd:o,[`${l}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${l}-unchecked`]:{marginInlineStart:`calc(100% - ${u} + ${x})`,marginInlineEnd:`calc(-100% + ${u} - ${x})`}},[`${t}-handle`]:{insetInlineStart:`calc(100% - ${E(r(a).add(i).equal())})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${l}`]:{[`${l}-unchecked`]:{marginInlineStart:r(n.marginXXS).div(2).equal(),marginInlineEnd:r(n.marginXXS).mul(-1).div(2).equal()}},[`&${t}-checked ${l}`]:{[`${l}-checked`]:{marginInlineStart:r(n.marginXXS).mul(-1).div(2).equal(),marginInlineEnd:r(n.marginXXS).div(2).equal()}}}}}}},Me=n=>{const{componentCls:t,handleSize:s,calc:i}=n;return{[t]:{[`${t}-loading-icon${n.iconCls}`]:{position:"relative",top:i(i(s).sub(n.fontSize)).div(2).equal(),color:n.switchLoadingIconColor,verticalAlign:"top"},[`&${t}-checked ${t}-loading-icon`]:{color:n.switchColor}}}},De=n=>{const{componentCls:t,trackPadding:s,handleBg:i,handleShadow:c,handleSize:h,calc:o}=n,a=`${t}-handle`;return{[t]:{[a]:{position:"absolute",top:s,insetInlineStart:s,width:h,height:h,transition:`all ${n.switchDuration} ease-in-out`,"&::before":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,backgroundColor:i,borderRadius:o(h).div(2).equal(),boxShadow:c,transition:`all ${n.switchDuration} ease-in-out`,content:'""'}},[`&${t}-checked ${a}`]:{insetInlineStart:`calc(100% - ${E(o(h).add(s).equal())})`},[`&:not(${t}-disabled):active`]:{[`${a}::before`]:{insetInlineEnd:n.switchHandleActiveInset,insetInlineStart:0},[`&${t}-checked ${a}::before`]:{insetInlineEnd:0,insetInlineStart:n.switchHandleActiveInset}}}}},Pe=n=>{const{componentCls:t,trackHeight:s,trackPadding:i,innerMinMargin:c,innerMaxMargin:h,handleSize:o,calc:a}=n,r=`${t}-inner`,l=E(a(o).add(a(i).mul(2)).equal()),u=E(a(h).mul(2).equal());return{[t]:{[r]:{display:"block",overflow:"hidden",borderRadius:100,height:"100%",paddingInlineStart:h,paddingInlineEnd:c,transition:`padding-inline-start ${n.switchDuration} ease-in-out, padding-inline-end ${n.switchDuration} ease-in-out`,[`${r}-checked, ${r}-unchecked`]:{display:"block",color:n.colorTextLightSolid,fontSize:n.fontSizeSM,transition:`margin-inline-start ${n.switchDuration} ease-in-out, margin-inline-end ${n.switchDuration} ease-in-out`,pointerEvents:"none",minHeight:s},[`${r}-checked`]:{marginInlineStart:`calc(-100% + ${l} - ${u})`,marginInlineEnd:`calc(100% - ${l} + ${u})`},[`${r}-unchecked`]:{marginTop:a(s).mul(-1).equal(),marginInlineStart:0,marginInlineEnd:0}},[`&${t}-checked ${r}`]:{paddingInlineStart:c,paddingInlineEnd:h,[`${r}-checked`]:{marginInlineStart:0,marginInlineEnd:0},[`${r}-unchecked`]:{marginInlineStart:`calc(100% - ${l} + ${u})`,marginInlineEnd:`calc(-100% + ${l} - ${u})`}},[`&:not(${t}-disabled):active`]:{[`&:not(${t}-checked) ${r}`]:{[`${r}-unchecked`]:{marginInlineStart:a(i).mul(2).equal(),marginInlineEnd:a(i).mul(-1).mul(2).equal()}},[`&${t}-checked ${r}`]:{[`${r}-checked`]:{marginInlineStart:a(i).mul(-1).mul(2).equal(),marginInlineEnd:a(i).mul(2).equal()}}}}}},Ae=n=>{const{componentCls:t,trackHeight:s,trackMinWidth:i}=n;return{[t]:Object.assign(Object.assign(Object.assign(Object.assign({},de(n)),{position:"relative",display:"inline-block",boxSizing:"border-box",minWidth:i,height:s,lineHeight:E(s),verticalAlign:"middle",background:n.colorTextQuaternary,border:"0",borderRadius:100,cursor:"pointer",transition:`all ${n.motionDurationMid}`,userSelect:"none",[`&:hover:not(${t}-disabled)`]:{background:n.colorTextTertiary}}),he(n)),{[`&${t}-checked`]:{background:n.switchColor,[`&:hover:not(${t}-disabled)`]:{background:n.colorPrimaryHover}},[`&${t}-loading, &${t}-disabled`]:{cursor:"not-allowed",opacity:n.switchDisabledOpacity,"*":{boxShadow:"none",cursor:"not-allowed"}},[`&${t}-rtl`]:{direction:"rtl"}})}},Te=n=>{const{fontSize:t,lineHeight:s,controlHeight:i,colorWhite:c}=n,h=t*s,o=i/2,a=2,r=h-a*2,l=o-a*2;return{trackHeight:h,trackHeightSM:o,trackMinWidth:r*2+a*4,trackMinWidthSM:l*2+a*2,trackPadding:a,handleBg:c,handleSize:r,handleSizeSM:l,handleShadow:`0 2px 4px 0 ${new me("#00230b").setA(.2).toRgbString()}`,innerMinMargin:r/2,innerMaxMargin:r+a+a*2,innerMinMarginSM:l/2,innerMaxMarginSM:l+a+a*2}},ze=oe("Switch",n=>{const t=le(n,{switchDuration:n.motionDurationMid,switchColor:n.colorPrimary,switchDisabledOpacity:n.opacityLoading,switchLoadingIconSize:n.calc(n.fontSizeIcon).mul(.75).equal(),switchLoadingIconColor:`rgba(0, 0, 0, ${n.opacityLoading})`,switchHandleActiveInset:"-30%"});return[Ae(t),Pe(t),De(t),Me(t),Ee(t)]},Te);var He=function(n,t){var s={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(s[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,i=Object.getOwnPropertySymbols(n);c<i.length;c++)t.indexOf(i[c])<0&&Object.prototype.propertyIsEnumerable.call(n,i[c])&&(s[i[c]]=n[i[c]]);return s};const qe=g.forwardRef((n,t)=>{const{prefixCls:s,size:i,disabled:c,loading:h,className:o,rootClassName:a,style:r,checked:l,value:u,defaultChecked:x,defaultValue:m,onChange:S}=n,b=He(n,["prefixCls","size","disabled","loading","className","rootClassName","style","checked","value","defaultChecked","defaultValue","onChange"]),[f,$]=V(!1,{value:l??u,defaultValue:x??m}),{getPrefixCls:I,direction:d,switch:p}=g.useContext(ue),M=g.useContext(ge),H=(c??M)||h,w=I("switch",s),q=g.createElement("div",{className:`${w}-handle`},h&&g.createElement(xe,{className:`${w}-loading-icon`})),[j,A,D]=ze(w),ne=pe(i),te=U(p==null?void 0:p.className,{[`${w}-small`]:ne==="small",[`${w}-loading`]:h,[`${w}-rtl`]:d==="rtl"},o,a,A,D),ie=Object.assign(Object.assign({},p==null?void 0:p.style),r),ae=(...O)=>{$(O[0]),S==null||S.apply(void 0,O)};return j(g.createElement(Se,{component:"Switch"},g.createElement(Z,Object.assign({},b,{checked:f,onChange:ae,prefixCls:w,className:te,style:ie,disabled:H,ref:t,loadingIcon:q}))))}),ee=qe;ee.__ANT_SWITCH=!0;const Re=({visible:n,onClose:t,onSave:s,initialValues:i})=>{const[c]=v.useForm();g.useEffect(()=>{n&&i?c.setFieldsValue({...i,options:i.options||[]}):c.resetFields()},[n,i]);const h=async o=>{var x;const{service_id:a,_id:r,...l}=o,u={...l,basePrice:Number(l.basePrice)||0,options:(l.options||[]).filter(m=>{var S,b;return((S=m==null?void 0:m.type)==null?void 0:S.trim())&&((b=m==null?void 0:m.description)==null?void 0:b.trim())})};try{i!=null&&i._id?(await P.put(`/api/service/${i._id}`,u),C.success("Service updated")):(await P.post("/api/service",u),C.success("Service added")),s(),t()}catch(m){C.error("Failed to save service"),console.error(((x=m==null?void 0:m.response)==null?void 0:x.data)||m.message)}};return e.jsx(F,{title:i?"Edit Service":"Add Service",open:n,onClose:t,width:640,destroyOnClose:!0,children:e.jsxs(v,{layout:"vertical",form:c,onFinish:h,children:[e.jsxs(L,{gutter:16,children:[e.jsx(T,{span:12,children:e.jsx(v.Item,{name:"serviceName",label:"Service Name",rules:[{required:!0,message:"Enter service name"}],children:e.jsx(k,{placeholder:"Service name"})})}),e.jsx(T,{span:12,children:e.jsx(v.Item,{name:"basePrice",label:"Base Price (INR)",rules:[{required:!0,message:"Enter base price"}],children:e.jsx(k,{type:"number",placeholder:"Base price"})})})]}),e.jsxs(L,{gutter:16,children:[e.jsx(T,{span:12,children:e.jsx(v.Item,{name:"category",label:"Category",placeholder:"e.g., Social Media, Brand Campaign",children:e.jsx(k,{placeholder:"Category"})})}),e.jsx(T,{span:12,children:e.jsx(v.Item,{name:"hsnSac",label:"HSN/SAC",children:e.jsx(k,{placeholder:"HSN/SAC Code (optional)"})})})]}),e.jsx(v.Item,{name:"description",label:"Description",children:e.jsx(k.TextArea,{rows:2,placeholder:"Service description"})}),e.jsx(v.List,{name:"options",children:(o,{add:a,remove:r})=>e.jsxs(e.Fragment,{children:[e.jsx("label",{style:{fontWeight:600},children:"Service Packages / Options"}),o.map(({key:l,name:u})=>e.jsxs(ve,{style:{display:"flex",marginBottom:8},align:"start",children:[e.jsx(v.Item,{name:[u,"type"],rules:[{required:!0,message:"Enter type"}],children:e.jsx(k,{placeholder:"Type (e.g., Campaign Package)"})}),e.jsx(v.Item,{name:[u,"description"],rules:[{required:!0,message:"Enter description"}],children:e.jsx(k,{placeholder:"Description"})}),e.jsx(je,{onClick:()=>r(u)})]},l)),e.jsx(v.Item,{children:e.jsx(N,{onClick:()=>a(),icon:e.jsx(G,{}),children:"Add Option"})})]})}),e.jsx(v.Item,{name:"isActive",label:"Active",valuePropName:"checked",children:e.jsx(ee,{})}),e.jsx(v.Item,{children:e.jsx(N,{type:"primary",style:{backgroundColor:"#0E2B43",borderColor:"#0E2B43",color:"white"},htmlType:"submit",block:!0,children:i?"Update":"Create"})})]})})},{TextArea:Fe}=k,{Title:Oe,Text:Be}=Ce,_e=({visible:n,onClose:t,product:s,refreshProducts:i})=>{const[c]=v.useForm(),[h,o]=g.useState(!1),[a,r]=g.useState([]);g.useEffect(()=>{r((s==null?void 0:s.notes)||[])},[s]);const l=()=>{try{const m=JSON.parse(localStorage.getItem("user"));return(m==null?void 0:m.email)||"Unknown"}catch{return"Unknown"}},u=async m=>{try{o(!0);const S=C.loading("Adding note..."),b={text:m.note,timestamp:new Date().toLocaleString(),author:l()},f=[...a,b];await P.put(`/api/product/${s._id}/notes`,{notes:f}),r(f),C.success("Note added",{id:S}),c.resetFields(),i()}catch{C.error("Failed to add note")}finally{o(!1)}},x=()=>a.length?a.map((m,S)=>{const b=S>0?a[S-1]:null,f=new Date(m.timestamp).toDateString(),$=b?new Date(b.timestamp).toDateString():null,I=f!==$;return e.jsxs("div",{children:[I&&e.jsx("div",{className:"note-date-header",children:f}),e.jsxs("div",{className:"note-bubble",children:[e.jsxs("div",{className:"note-meta",children:[m.author,"    ",m.timestamp]}),e.jsx("div",{className:"note-text",children:m.text})]})]},S)}):e.jsx(Be,{type:"secondary",children:"No notes added yet"});return e.jsx(F,{title:e.jsxs(Oe,{level:4,style:{margin:0},children:["Notes for Product: ",s==null?void 0:s.productName]}),open:n,onClose:t,width:440,destroyOnClose:!0,children:e.jsxs(be,{spinning:h,children:[e.jsx("div",{style:{maxHeight:460,overflowY:"auto",marginBottom:16},children:x()}),e.jsxs(v,{form:c,layout:"vertical",onFinish:u,children:[e.jsx(v.Item,{name:"note",rules:[{required:!0,message:"Please enter a note"}],children:e.jsx(Fe,{rows:3,placeholder:"Type your note here"})}),e.jsx(N,{type:"primary",style:{backgroundColor:"#0E2B43",borderColor:"#orange",color:"white"},htmlType:"submit",loading:h,block:!0,icon:e.jsx(fe,{}),children:"Add Note"})]})]})})},{Content:Le,Header:We}=J,{TabPane:K}=Q,{Panel:X}=Y,jn=()=>{var I;const[n,t]=g.useState([]),[s,i]=g.useState(!1),[c,h]=g.useState(null),[o,a]=g.useState(null),[r,l]=g.useState(!1),u=async()=>{try{const{data:d}=await P.get("/api/service");t(d)}catch{C.error("Failed to load services")}};g.useEffect(()=>{u()},[]);const x=()=>u(),m=async d=>{try{await P.delete(`/api/service/${d}`),C.success("Service deleted"),u()}catch{C.error("Failed to delete service")}},S=async d=>{try{const{data:p}=await P.get(`/api/service/${d}`);a(p)}catch{C.error("Failed to fetch service details")}},b=n.filter(d=>d.isActive),f=n.filter(d=>!d.isActive),$=()=>[{title:"S.No",render:(d,p,M)=>M+1,width:60},{title:"Name",dataIndex:"serviceName",width:160},{title:"Price (₹)",dataIndex:"basePrice",render:d=>`₹${d==null?void 0:d.toFixed(2)}`,width:100},{title:"Status",dataIndex:"isActive",render:d=>d?e.jsx(z,{color:"green",children:"Active"}):e.jsx(z,{color:"red",children:"Inactive"}),width:100},{title:"Actions",width:180,render:(d,p)=>e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"View",children:e.jsx(N,{type:"text",icon:e.jsx(ye,{}),onClick:()=>S(p._id)})}),e.jsx(R,{title:"Edit",children:e.jsx(N,{type:"text",icon:e.jsx(Ie,{}),onClick:()=>{h(p),i(!0)}})}),e.jsx(R,{title:"Notes",children:e.jsx(N,{type:"text",icon:e.jsx(we,{}),onClick:()=>{h(p),l(!0)}})}),e.jsx($e,{title:"Confirm delete?",onConfirm:()=>m(p._id),children:e.jsx(N,{type:"text",icon:e.jsx(ke,{}),danger:!0})})]})}];return e.jsxs(J,{style:{minHeight:"100vh",background:"#fff"},children:[e.jsx(We,{style:{background:"white",padding:0,marginBottom:20},children:e.jsx("h2",{style:{margin:0,padding:20},children:"Brand Service Management"})}),e.jsxs(Le,{style:{padding:20},children:[e.jsxs(Q,{defaultActiveKey:"1",children:[e.jsxs(K,{tab:"Active Services",children:[e.jsx(N,{type:"primary",icon:e.jsx(G,{}),onClick:()=>{h(null),i(!0)},style:{marginBottom:16,backgroundColor:"#0E2B43",borderColor:"#0E2B43",color:"white"},children:"Add Service"}),e.jsx(W,{columns:$(),dataSource:b,rowKey:"_id",scroll:{x:1e3},pagination:{pageSize:10}})]},"1"),e.jsx(K,{tab:"Inactive Services",children:e.jsx(W,{columns:$(),dataSource:f,rowKey:"_id",scroll:{x:1e3},pagination:{pageSize:10}})},"2")]}),e.jsx(Re,{visible:s,onClose:()=>{h(null),i(!1)},onSave:x,initialValues:c}),e.jsx(F,{open:!!o,title:"Service Details",width:820,onClose:()=>a(null),children:o&&e.jsxs(e.Fragment,{children:[e.jsxs(y,{bordered:!0,column:1,size:"small",children:[e.jsx(y.Item,{label:"Service ID",children:o.service_id}),e.jsx(y.Item,{label:"Name",children:o.serviceName}),e.jsxs(y.Item,{label:"Price",children:["₹",(I=o.basePrice)==null?void 0:I.toFixed(2)]}),e.jsx(y.Item,{label:"Description",children:o.description||"N/A"}),e.jsx(y.Item,{label:"Category",children:o.category||"N/A"}),e.jsx(y.Item,{label:"Status",children:o.isActive?e.jsx(z,{color:"green",children:"Active"}):e.jsx(z,{color:"red",children:"Inactive"})})]}),e.jsxs(Y,{style:{marginTop:20},children:[e.jsx(X,{header:"Service Packages / Options",children:Array.isArray(o.options)&&o.options.length>0?o.options.map((d,p)=>e.jsxs(y,{column:2,size:"small",bordered:!0,style:{marginBottom:16},children:[e.jsx(y.Item,{label:"Type",children:d.type}),e.jsx(y.Item,{label:"Description",children:d.description})]},p)):e.jsx("p",{children:"No service options available."})},"1"),e.jsx(X,{header:"Service Notes",children:Array.isArray(o.notes)&&o.notes.length>0?o.notes.map((d,p)=>e.jsxs(y,{column:2,size:"small",bordered:!0,style:{marginBottom:16},children:[e.jsx(y.Item,{label:"Note",span:2,children:d.text}),e.jsx(y.Item,{label:"Author",children:d.author}),e.jsx(y.Item,{label:"Time",children:new Date(d.timestamp).toLocaleString()})]},p)):e.jsx("p",{children:"No notes available."})},"2")]})]})}),c&&e.jsx(_e,{visible:r,onClose:()=>l(!1),service:c,refreshServices:u})]})]})};export{jn as default};
